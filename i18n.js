const translations = {
    en: {
        tagline: "Reveal less. Engage more.",
        hero_desc: "SoftReveal is not a 'image blurring' app. It is a tool for controlling the pace of information disclosure, born for the era of screen recording and visual storytelling.",
        enter_app: "Enter App",
        back_to_intro: "Back to Intro",
        donate: "Donate",

        // Intro Page
        what_is_title: "What is SoftReveal?",
        features: [
            { title: "Clipboard Ready", desc: "Paste images directly from your clipboard or drag and drop files." },
            { title: "Custom Blur", desc: "Define blur areas and intensity precisely to your needs." },
            { title: "Click to Reveal", desc: "Reveal hidden areas one by one during your recording or stream." },
            { title: "No Spoils", desc: "Keep the audience engaged by showing only what matters at the right moment." }
        ],
        problem_title: "The Problem We Solve",
        problem_desc: "In short videos and livestreams, content is often spoiled too early, causing viewers to drop off. SoftReveal gives you back control over curiosity.",
        targets_title: "Who is it for?",
        targets: [
            { title: "Content Creators", desc: "Keep viewers hooked for those 'A-ha!' moments in your breakdown videos." },
            { title: "Educators & Mentors", desc: "Explain complex documents by revealing parts as you speak." },
            { title: "Tech & Data People", desc: "Share logs or reports without leaking sensitive info immediately." },
            { title: "Social Media Analysts", desc: "Tell stories through comment chains or tweet threads with rhythm." }
        ],
        philosophy_quote: "Attention isn't lost because of bad content, but because it was revealed too early.",
        philosophy_tag: "SoftReveal — Control the moment, not just the image.",

        // App (index.html)
        app_empty_state: "Paste an image or Drag & Drop",
        app_ctrl_v: "Ctrl+V to paste from clipboard",
        app_tool_edit: "Edit Mode (R)",
        app_tool_present: "Present Mode (Space)",
        app_tool_rect: "Rectangle (R)",
        app_tool_circle: "Circle (C)",
        app_tool_zoom: "Zoom",
        app_tool_blur: "Blur",
        app_tool_reveal: "Reveal Animation",
        app_tool_snap: "Snap to Edges",
        app_tool_clear: "Clear All",
        i18n_toast_present: "You are in Present Mode. Right-click anywhere to stop."
    },
    vi: {
        tagline: "Tiết lộ ít hơn. Thu hút nhiều hơn.",
        hero_desc: "SoftReveal không phải là một app 'làm mờ ảnh'. Nó là một công cụ điều khiển nhịp hé lộ thông tin, sinh ra cho thời đại quay màn hình và kể chuyện bằng thị giác.",
        enter_app: "Vào ứng dụng",
        back_to_intro: "Về trang chủ",
        donate: "Ủng hộ",

        // Intro Page
        what_is_title: "SoftReveal là gì?",
        features: [
            { title: "Dán từ Clipboard", desc: "Dán ảnh trực tiếp từ clipboard hoặc kéo thả tệp tin." },
            { title: "Làm mờ tùy chỉnh", desc: "Xác định vùng làm mờ và cường độ chính xác theo nhu cầu." },
            { title: "Click để hé lộ", desc: "Hé lộ các vùng ẩn từng cái một trong khi quay màn hình hoặc stream." },
            { title: "Tránh spoil", desc: "Giữ người xem ở lại bằng cách chỉ cho thấy những gì quan trọng đúng lúc." }
        ],
        problem_title: "Vấn đề chúng tôi giải quyết",
        problem_desc: "Trong video ngắn và livestream, nội dung thường bị lộ quá sớm, khiến người xem rời đi. SoftReveal trả lại quyền kiểm soát sự tò mò cho bạn.",
        targets_title: "Dành cho ai?",
        targets: [
            { title: "Nhà sáng tạo nội dung", desc: "Giữ người xem đến những giây phút 'à ha' trong các video phân tích." },
            { title: "Người dạy & Mentor", desc: "Giải thích tài liệu phức tạp bằng cách hé lộ từng phần khi giảng bài." },
            { title: "Kỹ thuật & Dữ liệu", desc: "Chia sẻ log hoặc báo cáo mà không lộ thông tin nhạy cảm ngay lập tức." },
            { title: "Phân tích MXH", desc: "Kể chuyện qua các chuỗi bình luận hoặc tweet có nhịp điệu." }
        ],
        philosophy_quote: "Sự chú ý không mất đi vì nội dung kém, mà vì nội dung bị lộ quá sớm.",
        philosophy_tag: "SoftReveal — Điều khiển khoảnh khắc, không chỉ là hình ảnh.",

        // App (index.html)
        app_empty_state: "Dán ảnh hoặc Kéo thả vào đây",
        app_ctrl_v: "Ctrl+V để dán từ clipboard",
        app_tool_edit: "Chế độ Chỉnh sửa (R)",
        app_tool_present: "Chế độ Thuyết trình (Space)",
        app_tool_rect: "Hình chữ nhật (R)",
        app_tool_circle: "Hình tròn (C)",
        app_tool_zoom: "Thu phóng",
        app_tool_blur: "Độ mờ",
        app_tool_reveal: "Hiệu ứng mở",
        app_tool_snap: "Hút vào cạnh",
        app_tool_clear: "Xóa hết",
        i18n_toast_present: "Đang ở chế độ Thuyết trình. Chuột phải để dừng."
    },
    zh: {
        tagline: "揭示更少，吸引更多。",
        hero_desc: "SoftReveal 不是一個「模糊圖片」的應用。它是一個控制信息揭示節奏的工具，為螢幕錄製和視覺敘事時代而生。",
        enter_app: "進入應用",
        back_to_intro: "返回介紹",
        donate: "捐贈",

        // Intro Page
        what_is_title: "什麼是 SoftReveal？",
        features: [
            { title: "剪貼板支援", desc: "直接從剪貼板貼上圖片或拖放文件。" },
            { title: "自定義模糊", desc: "根據您的需求精確定義模糊區域和強度。" },
            { title: "點擊揭示", desc: "在錄製或直播期間逐一揭示隱藏區域。" },
            { title: "拒絕劇透", desc: "通過在正確的時刻僅顯示重要的內容來保持觀眾的參與度。" }
        ],
        problem_title: "我們解決的問題",
        problem_desc: "在短影片和直播中，內容往往過早劇透，導致觀眾流失。SoftReveal 讓您重新掌控好奇心。",
        targets_title: "適用對象？",
        targets: [
            { title: "內容創作者", desc: "在您的分析影片中讓觀眾為那些「原來如此」的時刻保持期待。" },
            { title: "教育者與導師", desc: "在講解時通過逐步揭示部分內容來解釋複雜文件。" },
            { title: "技術與數據人員", desc: "分享日誌或報告而不會立即洩露敏感信息。" },
            { title: "社群媒體分析師", desc: "有節奏地通過評論鏈或推文串講述故事。" }
        ],
        philosophy_quote: "注意力流失不是因為內容不好，而是因為它被揭示得太早了。",
        philosophy_tag: "SoftReveal — 掌控時刻，而不僅僅是圖像。",

        // App (index.html)
        app_empty_state: "貼上圖片或拖放文件",
        app_ctrl_v: "Ctrl+V 從剪貼板貼上",
        app_tool_edit: "編輯模式 (R)",
        app_tool_present: "演示模式 (Space)",
        app_tool_rect: "矩形 (R)",
        app_tool_circle: "圓形 (C)",
        app_tool_zoom: "縮放",
        app_tool_blur: "模糊度",
        app_tool_reveal: "揭示動畫",
        app_tool_snap: "自動貼齊",
        app_tool_clear: "清除全部",
        i18n_toast_present: "您正處於演示模式。在任意位置按右鍵即可停止。"
    }
};

function updateActiveButton(lang) {
    const langButtons = document.querySelectorAll('.lang-btn');
    langButtons.forEach(btn => {
        if (btn.getAttribute('data-lang') === lang) {
            btn.classList.add('active');
        } else {
            btn.classList.remove('active');
        }
    });
}

function updateLanguage(lang) {
    const t = translations[lang];
    if (!t) return;

    document.title = `SoftReveal — ${t.tagline}`;

    // Common
    const enterBtn = document.querySelector('.enter-btn:not(.secondary)');
    if (enterBtn) enterBtn.textContent = t.enter_app;

    const backBtn = document.querySelector('.enter-btn.secondary');
    if (backBtn) backBtn.textContent = t.back_to_intro;

    const donateBtn = document.querySelector('.donate-btn');
    if (donateBtn) {
        // Keep the icon
        const icon = donateBtn.querySelector('i');
        donateBtn.innerHTML = '';
        if (icon) donateBtn.appendChild(icon);
        donateBtn.appendChild(document.createTextNode(' ' + t.donate));
    }

    // Intro Page
    const tagline = document.querySelector('.tagline');
    const heroDesc = document.querySelector('.hero-desc');
    if (tagline) tagline.textContent = t.tagline;
    if (heroDesc) heroDesc.textContent = t.hero_desc;

    const whatIsTitle = document.querySelector('#what-is h2');
    if (whatIsTitle) whatIsTitle.textContent = t.what_is_title;

    const featureCards = document.querySelectorAll('#what-is .card');
    if (featureCards.length > 0) {
        t.features.forEach((f, i) => {
            if (featureCards[i]) {
                featureCards[i].querySelector('h3').textContent = f.title;
                featureCards[i].querySelector('p').textContent = f.desc;
            }
        });
    }

    const problemTitle = document.querySelector('#problem h2');
    const problemDesc = document.querySelector('#problem p');
    if (problemTitle) problemTitle.textContent = t.problem_title;
    if (problemDesc) problemDesc.textContent = t.problem_desc;

    const targetsTitle = document.querySelector('#targets h2');
    if (targetsTitle) targetsTitle.textContent = t.targets_title;

    const targetCards = document.querySelectorAll('#targets .card');
    if (targetCards.length > 0) {
        t.targets.forEach((ts, i) => {
            if (targetCards[i]) {
                targetCards[i].querySelector('h3').textContent = ts.title;
                targetCards[i].querySelector('p').textContent = ts.desc;
            }
        });
    }

    const quote = document.querySelector('.quote');
    const philDesc = document.querySelector('.philosophy p');
    if (quote) quote.textContent = t.philosophy_quote;
    if (philDesc) philDesc.textContent = t.philosophy_tag;

    // App (index.html)
    const emptyStateTitle = document.querySelector('#emptyState h2');
    const emptyStateP = document.querySelector('#emptyState p');
    if (emptyStateTitle) emptyStateTitle.textContent = t.app_empty_state;
    if (emptyStateP) emptyStateP.textContent = t.app_ctrl_v;

    if (document.getElementById('btnEdit')) document.getElementById('btnEdit').title = t.app_tool_edit;
    if (document.getElementById('btnPresent')) document.getElementById('btnPresent').title = t.app_tool_present;
    if (document.getElementById('btnRect')) document.getElementById('btnRect').title = t.app_tool_rect;
    if (document.getElementById('btnCircle')) document.getElementById('btnCircle').title = t.app_tool_circle;
    if (document.getElementById('btnClear')) document.getElementById('btnClear').title = t.app_tool_clear;

    const zoomLabel = document.querySelector('.tool-group.intensity-group span:first-child'); // Might be multiple
    const toolGroups = document.querySelectorAll('.tool-group.intensity-group');
    toolGroups.forEach(group => {
        const span = group.querySelector('span');
        if (span) {
            if (group.querySelector('#zoomSlider')) span.textContent = t.app_tool_zoom;
            if (group.querySelector('#blurSlider')) span.textContent = t.app_tool_blur;
            if (group.querySelector('#revealAnimSelect')) span.textContent = t.app_tool_reveal;
        }
    });

    const snapLabel = document.querySelector('.toggle-label');
    if (snapLabel) snapLabel.textContent = t.app_tool_snap;

    updateActiveButton(lang);
}

// Global Event Delegation for Lang Buttons
document.addEventListener('click', (e) => {
    const btn = e.target.closest('.lang-btn');
    if (btn) {
        const lang = btn.getAttribute('data-lang');
        updateLanguage(lang);
        localStorage.setItem('softreveal_lang', lang);
    }
});

// Init
const savedLang = localStorage.getItem('softreveal_lang') || 'en';
updateLanguage(savedLang);
